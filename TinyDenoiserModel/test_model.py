import onnxruntime as ort
import numpy as np

test_data = np.array([[[-0.07882494],
                       [-0.78509321],
                       [-0.7258503],
                       [0.77627768],
                       [0.66143638],
                       [0.9405806],
                       [0.23252621],
                       [-0.56000659],
                       [-0.2521177],
                       [-0.3419224],
                       [0.26434342],
                       [0.61925452],
                       [0.29043738],
                       [-0.4756347],
                       [-0.06087978],
                       [0.67780363],
                       [-0.26461738],
                       [-0.10966271],
                       [-0.31105678],
                       [-0.33246396],
                       [-0.55735619],
                       [-0.61016446],
                       [0.38016621],
                       [0.10358622],
                       [-0.22683132],
                       [-0.62536004],
                       [-0.52709448],
                       [-0.94083557],
                       [-0.50009169],
                       [-0.54244678],
                       [-0.0775174],
                       [-0.93130772],
                       [0.64097592],
                       [0.84189556],
                       [-0.10372878],
                       [-0.28639737],
                       [-0.02933283],
                       [-0.59716739],
                       [-0.32144393],
                       [-0.29083941],
                       [-0.40902322],
                       [-0.84024254],
                       [-0.354526],
                       [0.76655162],
                       [-0.76949814],
                       [0.44749193],
                       [-0.59713734],
                       [-0.22045572],
                       [-0.06853448],
                       [-0.85385346],
                       [0.45179226],
                       [0.94790547],
                       [0.95636841],
                       [0.52008252],
                       [0.41968019],
                       [-0.47477866],
                       [0.54734237],
                       [-0.15476558],
                       [0.2324944],
                       [-0.56120842],
                       [0.92517248],
                       [0.05720252],
                       [-0.34261229],
                       [-0.68834308],
                       [-0.22763201],
                       [-0.61297305],
                       [-0.86992699],
                       [0.04949611],
                       [0.46874574],
                       [0.57357715],
                       [0.82083892],
                       [0.07038925],
                       [0.00454734],
                       [-0.18961375],
                       [0.28293371],
                       [0.67857096],
                       [0.70090894],
                       [-0.10037076],
                       [0.51452656],
                       [-0.70960249],
                       [-0.24128505],
                       [-0.95464337],
                       [-0.37980288],
                       [0.1984061],
                       [-0.85635756],
                       [-0.70768825],
                       [-0.9078072],
                       [-0.53328739],
                       [-0.71346517],
                       [-0.15254658],
                       [0.7423086],
                       [0.61547725],
                       [-0.17757588],
                       [-0.09728307],
                       [-0.96871529],
                       [-0.54283983],
                       [0.84346809],
                       [-0.07259247],
                       [0.05909187],
                       [-0.84831126],
                       [0.64200401],
                       [-0.4329532],
                       [-0.90319878],
                       [0.06987025],
                       [0.25835816],
                       [-0.98860712],
                       [-0.95457428],
                       [-0.74805204],
                       [-0.75183718],
                       [0.50946534],
                       [-0.61836642],
                       [0.81286919],
                       [-0.3494267],
                       [0.97998125],
                       [0.61555105],
                       [0.20507646],
                       [-0.52341271],
                       [-0.05736871],
                       [0.8469073],
                       [0.22700132],
                       [0.61251285],
                       [0.09525037],
                       [0.84223844],
                       [0.17930586],
                       [0.8193469],
                       [0.46628656],
                       [-0.17106847],
                       [0.65635758],
                       [-0.83420331],
                       [-0.95669667],
                       [0.97324197],
                       [0.16998406],
                       [-0.0096312],
                       [-0.54299603],
                       [0.08090552],
                       [0.20100732],
                       [-0.39854013],
                       [-0.61230117],
                       [-0.07967114],
                       [0.7225014],
                       [-0.50041056],
                       [0.06920175],
                       [0.13899331],
                       [0.6262772],
                       [-0.45775053],
                       [0.66942861],
                       [-0.98381645],
                       [-0.22699188],
                       [-0.11297529],
                       [-0.48894028],
                       [-0.12849601],
                       [0.80948685],
                       [0.28885433],
                       [-0.50879052],
                       [-0.41383688],
                       [-0.53956644],
                       [0.6344315],
                       [-0.36775819],
                       [0.78683872],
                       [-0.50839603],
                       [-0.08792324],
                       [-0.84382341],
                       [-0.12497465],
                       [0.77528152],
                       [-0.35619713],
                       [0.29691948],
                       [-0.77688149],
                       [-0.6306732],
                       [0.07286399],
                       [-0.31839674],
                       [0.91284136],
                       [0.10645979],
                       [-0.44256238],
                       [-0.37515726],
                       [0.23056539],
                       [-0.70552085],
                       [-0.39676927],
                       [-0.56725182],
                       [-0.38514074],
                       [-0.47163709],
                       [0.88737064],
                       [0.65625784],
                       [-0.48715506],
                       [-0.80403674],
                       [0.43841511],
                       [0.75046172],
                       [0.55856888],
                       [-0.1369066],
                       [0.82242227],
                       [0.06900908],
                       [0.99882987],
                       [0.60895619],
                       [0.95455468],
                       [-0.25367984],
                       [0.74711712],
                       [-0.61115109],
                       [-0.75720627],
                       [0.23969158],
                       [0.06947253],
                       [-0.68993361],
                       [-0.278642],
                       [0.48907664],
                       [0.23570734],
                       [0.08366088],
                       [0.22880857],
                       [-0.17425753],
                       [0.10443157],
                       [0.60429078],
                       [0.00951284],
                       [-0.97184727],
                       [0.69363607],
                       [0.3681106],
                       [-0.30806945],
                       [-0.59047025],
                       [0.17716675],
                       [-0.01776544],
                       [0.23188452],
                       [-0.78563728],
                       [0.71587698],
                       [-0.75205242],
                       [0.14047634],
                       [0.47187649],
                       [0.42547647],
                       [-0.95447321],
                       [-0.09796836],
                       [0.53215892],
                       [-0.18473518],
                       [0.09257838],
                       [0.59915133],
                       [0.62949707],
                       [-0.30363615],
                       [0.54139057],
                       [0.95674874],
                       [0.64503984],
                       [0.22764157],
                       [-0.97868512],
                       [0.32411267],
                       [-0.12441069],
                       [0.96099791],
                       [-0.0217678],
                       [0.51493437],
                       [0.39297568],
                       [0.51687258],
                       [0.08421333],
                       [-0.00584229],
                       [0.05638147],
                       [0.92319746],
                       [-0.87024594],
                       [-0.13969839],
                       [0.91023789],
                       [-0.01363805],
                       [-0.0432568],
                       [0.33101641],
                       [0.55607275],
                       [-0.36797399],
                       [-0.48790539],
                       [-0.45781331]],
                      [[-0.07882494],
                     [-0.78509321],
                     [-0.7258503],
                     [0.77627768],
                     [0.66143638],
                     [0.9405806],
                     [0.23252621],
                     [-0.56000659],
                     [-0.2521177],
                     [-0.3419224],
                     [0.26434342],
                     [0.61925452],
                     [0.29043738],
                     [-0.4756347],
                     [-0.06087978],
                     [0.67780363],
                     [-0.26461738],
                     [-0.10966271],
                     [-0.31105678],
                     [-0.33246396],
                     [-0.55735619],
                     [-0.61016446],
                     [0.38016621],
                     [0.10358622],
                     [-0.22683132],
                     [-0.62536004],
                     [-0.52709448],
                     [-0.94083557],
                     [-0.50009169],
                     [-0.54244678],
                     [-0.0775174],
                     [-0.93130772],
                     [0.64097592],
                     [0.84189556],
                     [-0.10372878],
                     [-0.28639737],
                     [-0.02933283],
                     [-0.59716739],
                     [-0.32144393],
                     [-0.29083941],
                     [-0.40902322],
                     [-0.84024254],
                     [-0.354526],
                     [0.76655162],
                     [-0.76949814],
                     [0.44749193],
                     [-0.59713734],
                     [-0.22045572],
                     [-0.06853448],
                     [-0.85385346],
                     [0.45179226],
                     [0.94790547],
                     [0.95636841],
                     [0.52008252],
                     [0.41968019],
                     [-0.47477866],
                     [0.54734237],
                     [-0.15476558],
                     [0.2324944],
                     [-0.56120842],
                     [0.92517248],
                     [0.05720252],
                     [-0.34261229],
                     [-0.68834308],
                     [-0.22763201],
                     [-0.61297305],
                     [-0.86992699],
                     [0.04949611],
                     [0.46874574],
                     [0.57357715],
                     [0.82083892],
                     [0.07038925],
                     [0.00454734],
                     [-0.18961375],
                     [0.28293371],
                     [0.67857096],
                     [0.70090894],
                     [-0.10037076],
                     [0.51452656],
                     [-0.70960249],
                     [-0.24128505],
                     [-0.95464337],
                     [-0.37980288],
                     [0.1984061],
                     [-0.85635756],
                     [-0.70768825],
                     [-0.9078072],
                     [-0.53328739],
                     [-0.71346517],
                     [-0.15254658],
                     [0.7423086],
                     [0.61547725],
                     [-0.17757588],
                     [-0.09728307],
                     [-0.96871529],
                     [-0.54283983],
                     [0.84346809],
                     [-0.07259247],
                     [0.05909187],
                     [-0.84831126],
                     [0.64200401],
                     [-0.4329532],
                     [-0.90319878],
                     [0.06987025],
                     [0.25835816],
                     [-0.98860712],
                     [-0.95457428],
                     [-0.74805204],
                     [-0.75183718],
                     [0.50946534],
                     [-0.61836642],
                     [0.81286919],
                     [-0.3494267],
                     [0.97998125],
                     [0.61555105],
                     [0.20507646],
                     [-0.52341271],
                     [-0.05736871],
                     [0.8469073],
                     [0.22700132],
                     [0.61251285],
                     [0.09525037],
                     [0.84223844],
                     [0.17930586],
                     [0.8193469],
                     [0.46628656],
                     [-0.17106847],
                     [0.65635758],
                     [-0.83420331],
                     [-0.95669667],
                     [0.97324197],
                     [0.16998406],
                     [-0.0096312],
                     [-0.54299603],
                     [0.08090552],
                     [0.20100732],
                     [-0.39854013],
                     [-0.61230117],
                     [-0.07967114],
                     [0.7225014],
                     [-0.50041056],
                     [0.06920175],
                     [0.13899331],
                     [0.6262772],
                     [-0.45775053],
                     [0.66942861],
                     [-0.98381645],
                     [-0.22699188],
                     [-0.11297529],
                     [-0.48894028],
                     [-0.12849601],
                     [0.80948685],
                     [0.28885433],
                     [-0.50879052],
                     [-0.41383688],
                     [-0.53956644],
                     [0.6344315],
                     [-0.36775819],
                     [0.78683872],
                     [-0.50839603],
                     [-0.08792324],
                     [-0.84382341],
                     [-0.12497465],
                     [0.77528152],
                     [-0.35619713],
                     [0.29691948],
                     [-0.77688149],
                     [-0.6306732],
                     [0.07286399],
                     [-0.31839674],
                     [0.91284136],
                     [0.10645979],
                     [-0.44256238],
                     [-0.37515726],
                     [0.23056539],
                     [-0.70552085],
                     [-0.39676927],
                     [-0.56725182],
                     [-0.38514074],
                     [-0.47163709],
                     [0.88737064],
                     [0.65625784],
                     [-0.48715506],
                     [-0.80403674],
                     [0.43841511],
                     [0.75046172],
                     [0.55856888],
                     [-0.1369066],
                     [0.82242227],
                     [0.06900908],
                     [0.99882987],
                     [0.60895619],
                     [0.95455468],
                     [-0.25367984],
                     [0.74711712],
                     [-0.61115109],
                     [-0.75720627],
                     [0.23969158],
                     [0.06947253],
                     [-0.68993361],
                     [-0.278642],
                     [0.48907664],
                     [0.23570734],
                     [0.08366088],
                     [0.22880857],
                     [-0.17425753],
                     [0.10443157],
                     [0.60429078],
                     [0.00951284],
                     [-0.97184727],
                     [0.69363607],
                     [0.3681106],
                     [-0.30806945],
                     [-0.59047025],
                     [0.17716675],
                     [-0.01776544],
                     [0.23188452],
                     [-0.78563728],
                     [0.71587698],
                     [-0.75205242],
                     [0.14047634],
                     [0.47187649],
                     [0.42547647],
                     [-0.95447321],
                     [-0.09796836],
                     [0.53215892],
                     [-0.18473518],
                     [0.09257838],
                     [0.59915133],
                     [0.62949707],
                     [-0.30363615],
                     [0.54139057],
                     [0.95674874],
                     [0.64503984],
                     [0.22764157],
                     [-0.97868512],
                     [0.32411267],
                     [-0.12441069],
                     [0.96099791],
                     [-0.0217678],
                     [0.51493437],
                     [0.39297568],
                     [0.51687258],
                     [0.08421333],
                     [-0.00584229],
                     [0.05638147],
                     [0.92319746],
                     [-0.87024594],
                     [-0.13969839],
                     [0.91023789],
                     [-0.01363805],
                     [-0.0432568],
                     [0.33101641],
                     [0.55607275],
                     [-0.36797399],
                     [-0.48790539],
                     [-0.45781331]]]).astype(np.float32)

ort_sess = ort.InferenceSession(
    'src/damc/damc_audio_processing/TinyDenoiserModel/denoiser_LSTM_Valetini.onnx')
outputs = ort_sess.run(None, {'input': test_data})

print("model_data_type_t output[1][257][1] = {{")
for i in range(257):
    value = outputs[0][0][i][0].astype(np.float16)
    print(f"{value:e}", end="")
    if i == 256:
        pass
    elif (i + 1) % 6 == 0:
        print(",\n", end="")
    else:
        print(",  ", end="")
print()
